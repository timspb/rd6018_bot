# RD6018 Smart AI Controller: Telegram Edition

[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://python.org)
[![Aiogram](https://img.shields.io/badge/Aiogram-3.x-green.svg)](https://aiogram.dev)
[![Home Assistant](https://img.shields.io/badge/Home%20Assistant-API-orange.svg)](https://home-assistant.io)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–º –±–ª–æ–∫–æ–º –ø–∏—Ç–∞–Ω–∏—è **RD6018** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏ —Ä—É—á–Ω–æ–π –∑–∞—Ä—è–¥–∫–∏ —Å–≤–∏–Ω—Ü–æ–≤–æ-–∫–∏—Å–ª–æ—Ç–Ω—ã—Ö –ê–ö–ë (Ca/Ca, EFB, AGM) —á–µ—Ä–µ–∑ **Home Assistant** —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≤ **Telegram**: –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã, —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, –∑–∞—â–∏—Ç—ã –∏ AI-–∞–Ω–∞–ª–∏–∑.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ì—Ä–∞—Ñ–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** ‚Äî –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ, —Ç–æ–∫, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ Telegram —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- **–ê–≤—Ç–æ–∑–∞—Ä—è–¥ –ø–æ –ø—Ä–æ—Ñ–∏–ª—è–º** ‚Äî Ca/Ca, EFB, AGM —Å –¥–µ—Å—É–ª—å—Ñ–∞—Ç–∞—Ü–∏–µ–π, Mix –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ñ–∏–Ω–∏—à–µ–º
- **–†—É—á–Ω–æ–π —Ä–µ–∂–∏–º (Custom)** ‚Äî —Å–≤–æ–∏ —É—Å—Ç–∞–≤–∫–∏ Main/Mix, –¥–µ–ª—å—Ç–∞-—Ç—Ä–∏–≥–≥–µ—Ä –∏ –ª–∏–º–∏—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- **–õ–æ–≥–∏ —Å–æ–±—ã—Ç–∏–π** ‚Äî —Å—Ç–∞—Ä—Ç/–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —ç—Ç–∞–ø–æ–≤, —ë–º–∫–æ—Å—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ, —Ç—Ä–∏–≥–≥–µ—Ä—ã (‚îî) –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- **AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç** ‚Äî –∞–Ω–∞–ª–∏–∑ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ —á–µ—Ä–µ–∑ DeepSeek (—Ñ–∞–∑–∞, –∞–Ω–æ–º–∞–ª–∏–∏, –ø—Ä–æ–≥–Ω–æ–∑)
- **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏** ‚Äî –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∑–∞—Ä—è–¥–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (charge_session.json)
- **–ö–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã** ‚Äî –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º (–Ω–µ –Ω–∏–∂–µ 10¬∞C), –≤–æ –≤—Ä–µ–º—è –∑–∞—Ä—è–¥–∞ (35/40/45¬∞C)

---

## üìã –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–∑–∞—Ä—è–¥–∞

### –≠—Ç–∞–ø—ã (FSM)

| –≠—Ç–∞–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞** | –ú—è–≥–∫–∏–π —Å—Ç–∞—Ä—Ç 12.0–í/0.5–ê –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è ~12–í –Ω–∞ –∫–ª–µ–º–º–∞—Ö |
| **Main Charge** | –û—Å–Ω–æ–≤–Ω–∞—è —Ñ–∞–∑–∞: —Ü–µ–ª–µ–≤–æ–µ U –ø–æ –ø—Ä–æ—Ñ–∏–ª—é (14.4‚Äì15.0–í), —Ç–æ–∫ –¥–æ –ª–∏–º–∏—Ç–∞ (CC ‚Üí CV) |
| **–î–µ—Å—É–ª—å—Ñ–∞—Ç–∞—Ü–∏—è** | –ü—Ä–∏ ¬´–∑–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏–∏¬ª —Ç–æ–∫–∞: 16.3–í/2% Ah –¥–æ 2 —á (Ca/EFB ‚Äî –¥–æ 3 —Ü–∏–∫–ª–æ–≤, AGM ‚Äî –¥–æ 4) |
| **Mix Mode** | –§–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—ä—ë–º (16.5–í –∏ —Ç.–ø.), –≤—ã—Ö–æ–¥ –ø–æ –¥–µ–ª—å—Ç–∞-V/–¥–µ–ª—å—Ç–∞-I –∏–ª–∏ –ª–∏–º–∏—Ç—É –≤—Ä–µ–º–µ–Ω–∏ |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ** | –í—ã—Ö–æ–¥ –≤—ã–∫–ª—é—á–µ–Ω, –æ–∂–∏–¥–∞–Ω–∏–µ –ø–∞–¥–µ–Ω–∏—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ ‚àí0.5–í (–º–∞–∫—Å 2 —á) |
| **Done** | –†–µ–∂–∏–º —Ö—Ä–∞–Ω–µ–Ω–∏—è (13.2‚Äì13.8–í) –∏–ª–∏ –ø–æ–ª–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ |
| **üå° –û—Å—Ç—ã–≤–∞–Ω–∏–µ** | –ü—Ä–∏ 40¬∞C: –ø–∞—É–∑–∞ –∑–∞—Ä—è–¥–∞ –¥–æ —Å–Ω–∏–∂–µ–Ω–∏—è –¥–æ 35¬∞C |

### –ü—Ä–æ—Ñ–∏–ª–∏ (—É—Å—Ç–∞–≤–∫–∏ –∏ –ª–∏–º–∏—Ç—ã)

- **Ca/Ca** ‚Äî Main 14.7–í/5–ê, Mix –¥–æ 8 —á, —Ö—Ä–∞–Ω–µ–Ω–∏–µ 13.8–í  
- **EFB** ‚Äî Main 14.4–í/5–ê, Mix –¥–æ 10 —á, —Ö—Ä–∞–Ω–µ–Ω–∏–µ 13.8–í  
- **AGM** ‚Äî 4 —Å—Ç—É–ø–µ–Ω–∏ 14.4‚Üí14.6‚Üí14.8‚Üí15.0–í (–Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—É–ø–µ–Ω–∏ –∏ –ø–µ—Ä–µ–¥ Mix: —Ç–æ–∫ &lt;0.2–ê –≤ —Ç–µ—á–µ–Ω–∏–µ **2 —á** –±–µ–∑ –Ω–æ–≤–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞), –∑–∞—Ç–µ–º Mix –¥–æ 5 —á  

### –¢—Ä–∏–≥–≥–µ—Ä—ã –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (–∞–≤—Ç–æ)

- **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ ‚Üí Main:** –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –Ω–∞ –ê–ö–ë ‚â• 12.0–í  
- **Main ‚Üí Mix (Ca/EFB):** —Ä–µ–∂–∏–º CV –∏ —Ç–æ–∫ &lt;0.3–ê –≤ —Ç–µ—á–µ–Ω–∏–µ **3 —á** –±–µ–∑ –Ω–æ–≤–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞  
- **Main ‚Üí Mix (AGM):** –Ω–∞ –≤—Å–µ—Ö —Å—Ç—É–ø–µ–Ω—è—Ö –¥–æ 15–í –∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤ Mix ‚Äî —Ç–æ–∫ &lt;0.2–ê –≤ —Ç–µ—á–µ–Ω–∏–µ **2 —á** –±–µ–∑ –Ω–æ–≤–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞  
- **Main ‚Üí –î–µ—Å—É–ª—å—Ñ–∞—Ç–∞—Ü–∏—è:** —Ç–æ–∫ ¬´–∑–∞—Å—Ç—Ä—è–ª¬ª ‚â•0.3–ê (Ca/EFB) –∏–ª–∏ ‚â•0.2–ê (AGM) **‚â•40 –º–∏–Ω**  
- **Mix ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ:** —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ **–¥–µ–ª—å—Ç–∞-—Ç—Ä–∏–≥–≥–µ—Ä–∞** (dV –∏–ª–∏ dI) –∏ –∑–∞—Ç–µ–º **—Ç–∞–π–º–µ—Ä 2 —á**  
- **–î–µ—Å—É–ª—å—Ñ–∞—Ç–∞—Ü–∏—è ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ:** —Ä–æ–≤–Ω–æ **2 —á** –Ω–∞ —ç—Ç–∞–ø–µ  
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ ‚Üí Main/Done:** –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ —É–ø–∞–ª–æ –¥–æ (—Ü–µ–ª–µ–≤–æ–µ ‚àí 0.5–í) –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç 2 —á  

–î–µ–ª—å—Ç–∞-—Ç—Ä–∏–≥–≥–µ—Ä –≤ Mix: —Å–ø–∞–¥ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –æ—Ç –ø–∏–∫–∞ ‚â•0.03–í –∏–ª–∏ —Ä–æ—Å—Ç —Ç–æ–∫–∞ –æ—Ç –º–∏–Ω–∏–º—É–º–∞ ‚â•0.03–ê, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ **3 –∑–∞–º–µ—Ä–∞–º–∏ –ø–æ–¥—Ä—è–¥** —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 1 –º–∏–Ω. –ü–æ—Å–ª–µ —Å–º–µ–Ω—ã —É—Å—Ç–∞–≤–æ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ dV/dI –≤–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **120 —Å** (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤).

---

## üõ† –õ–æ–≥–∏–∫–∞ —Ä—É—á–Ω–æ–≥–æ –∑–∞—Ä—è–¥–∞ (Custom)

### –ß—Ç–æ –∑–∞–¥–∞—ë—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

1. **–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ Main** (12.0‚Äì17.0–í) ‚Äî —Ü–µ–ª–µ–≤–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–∑—ã  
2. **–¢–æ–∫ Main** (0.1‚Äì18.0–ê) ‚Äî –ª–∏–º–∏—Ç —Ç–æ–∫–∞ (–ø—Ä–∏ 10.1‚Äì18–ê –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)  
3. **–î–µ–ª—å—Ç–∞ (dV/dI)** ‚Äî –ø–æ—Ä–æ–≥ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Ñ–∏–Ω–∏—à–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.03–í)  
4. **–õ–∏–º–∏—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏** (1‚Äì72 —á) ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç—Ç–∞–ø–∞ Main  
5. **–Å–º–∫–æ—Å—Ç—å –ê–ö–ë (Ah)** ‚Äî –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –ª–æ–≥–∏–∫–∏ (–Ω–µ –¥–ª—è –∂—ë—Å—Ç–∫–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–æ Ah)  

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ

- –°—Ç–∞—Ä—Ç —Å—Ä–∞–∑—É —Å —ç—Ç–∞–ø–∞ **Main** (–±–µ–∑ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∏), —É—Å—Ç–∞–≤–∫–∏ RD6018 = Main V/I  
- –í—ã—Ö–æ–¥ –∏–∑ Main —Ç–æ–ª—å–∫–æ –ø–æ **–¥–µ–ª—å—Ç–∞-—Ç—Ä–∏–≥–≥–µ—Ä—É** (—Ç–µ –∂–µ 0.03–í/0.03–ê, 3 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 1 –º–∏–Ω) –∏–ª–∏ –ø–æ **–ª–∏–º–∏—Ç—É –≤—Ä–µ–º–µ–Ω–∏**  
- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏: –µ—Å–ª–∏ —É–∂–µ CV –∏ —Ç–æ–∫ ‚â§ –ø–æ—Ä–æ–≥–∞ (0.3–ê) ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –≤ Mix; –∏–Ω–∞—á–µ ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ (Done)  
- OVP/OCP –≤—ã—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (U_target+0.5–í, I_limit+0.5–ê)  

–ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º (–∫–∞–∫ –∏ –≤ –∞–≤—Ç–æ) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **–≤–Ω–µ—à–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞**: –ø—Ä–∏ &lt;10¬∞C –∑–∞—Ä—è–¥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è.

---

## ‚ö° –¢—Ä–∏–≥–≥–µ—Ä—ã –∏ —É—Å–ª–æ–≤–∏—è

| –¢—Ä–∏–≥–≥–µ—Ä | –£—Å–ª–æ–≤–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|--------|--------|----------|
| **V ‚â• 12–í** | –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –Ω–∞ –∫–ª–µ–º–º–∞—Ö –ø–æ—Å–ª–µ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∏ | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ ‚Üí Main |
| **I &lt; 0.3–ê (3 —á)** | Ca/EFB: —Ç–æ–∫ –¥–µ—Ä–∂–∏—Ç—Å—è –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞ 3 —á –±–µ–∑ –Ω–æ–≤–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞ | Main ‚Üí Mix |
| **I &lt; 0.2–ê (2 —á)** | AGM: –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—É–ø–µ–Ω–∏ –∏ –ø–µ—Ä–µ–¥ Mix ‚Äî –±–µ–∑ –Ω–æ–≤–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞ | Main ‚Üí —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—É–ø–µ–Ω—å –∏–ª–∏ Mix |
| **I –∑–∞—Å—Ç—Ä—è–ª 40 –º–∏–Ω** | –¢–æ–∫ ‚â•0.3–ê (–∏–ª–∏ ‚â•0.2–ê AGM) –≤ CV –Ω–µ –ø–∞–¥–∞–µ—Ç 40 –º–∏–Ω | Main ‚Üí –î–µ—Å—É–ª—å—Ñ–∞—Ç–∞—Ü–∏—è |
| **–î–µ–ª—å—Ç–∞ V ‚â• 0.03–í** | –í Mix: —Å–ø–∞–¥ –æ—Ç –ø–∏–∫–∞ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è, 3√ó1 –º–∏–Ω | –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ 2 —á ‚Üí –∑–∞—Ç–µ–º Safe Wait |
| **–î–µ–ª—å—Ç–∞ I ‚â• 0.03–ê** | –í Mix: —Ä–æ—Å—Ç –æ—Ç –º–∏–Ω–∏–º—É–º–∞ —Ç–æ–∫–∞, 3√ó1 –º–∏–Ω | –¢–æ –∂–µ |
| **–¢–∞–π–º–µ—Ä 2 —á** | –ü–æ—Å–ª–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –¥–µ–ª—å—Ç—ã –≤ Mix –ø—Ä–æ—à–ª–æ 2 —á | Mix ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ |
| **–õ–∏–º–∏—Ç Mix** | 8 —á (Ca), 10 —á (EFB), 5 —á (AGM) | Mix ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ |
| **–õ–∏–º–∏—Ç Main 72 —á** | –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏—è (–∞–≤—Ç–æ) | –ü—Ä–∏ I‚â§–ø–æ—Ä–æ–≥–∞ ‚Üí Mix, –∏–Ω–∞—á–µ Done |
| **–õ–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ Custom** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ª–∏–º–∏—Ç Main | –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ: Mix –∏–ª–∏ Done |
| **V —É–ø–∞–ª–æ** | –í –ë–µ–∑–æ–ø–∞—Å–Ω–æ–º –æ–∂–∏–¥–∞–Ω–∏–∏ U ‚â§ —Ü–µ–ª–µ–≤–æ–µ‚àí0.5–í | –í–∫–ª—é—á–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞, –ø–µ—Ä–µ—Ö–æ–¥ –≤ Main –∏–ª–∏ Done |
| **–¢–∞–π–º–∞—É—Ç Safe Wait 2 —á** | –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –Ω–µ —É–ø–∞–ª–æ –∑–∞ 2 —á | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –¥–∞–ª—å—à–µ |

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–º–µ–Ω—ã —ç—Ç–∞–ø–∞/—É—Å—Ç–∞–≤–æ–∫ –¥–µ–π—Å—Ç–≤—É–µ—Ç **–±–ª–∞–Ω–∫–∏–Ω–≥ 5 –º–∏–Ω** ‚Äî —Ç—Ä–∏–≥–≥–µ—Ä—ã –ø–æ —Ç–æ–∫—É/–Ω–∞–ø—Ä—è–∂–µ–Ω–∏—é –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.

---

## üõ° –ó–∞—â–∏—Ç—ã

### –ü–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º

- **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –¥–∞—Ç—á–∏–∫–∞ &lt; 10¬∞C** ‚Äî –∑–∞—Ä—è–¥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è (–∞–≤—Ç–æ –∏ Custom). –°–æ–æ–±—â–µ–Ω–∏–µ: ¬´–ü—Ä–æ–≥—Ä–µ–π—Ç–µ –ê–ö–ë –∏–ª–∏ –ø–æ–º–µ—â–µ–Ω–∏–µ¬ª.

### –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞—Ä—è–¥–∞ (–≤–Ω–µ—à–Ω–∏–π –¥–∞—Ç—á–∏–∫ –ê–ö–ë)

- **35¬∞C** ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ Telegram (–æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ —Å–µ—Å—Å–∏—é)  
- **40¬∞C** ‚Äî –≤—ã—Ö–æ–¥ –≤—ã–∫–ª—é—á–µ–Ω, —ç—Ç–∞–ø **üå° –û—Å—Ç—ã–≤–∞–Ω–∏–µ**; –≤–æ–∑–≤—Ä–∞—Ç –∫ –∑–∞—Ä—è–¥—É –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –¥–æ 35¬∞C  
- **45¬∞C** ‚Äî –∞–≤–∞—Ä–∏–π–Ω—ã–π —Å–±—Ä–æ—Å –≤ Idle, –ø–æ–ª–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ  

### –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ –ª–∏–º–∏—Ç—ã

- **OVP/OCP** ‚Äî –ø—Ä–∏ –∫–∞–∂–¥–æ–π —Å–º–µ–Ω–µ —ç—Ç–∞–ø–∞: OVP = U_target + 0.5–í, OCP = I_limit + 0.5–ê  
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ** ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤ –∫–æ–Ω—Ñ–∏–≥–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä 17.5–í)  
- **Watchdog —Å–≤—è–∑—å —Å HA** ‚Äî –ø–æ—Ç–µ—Ä—è —Å–≤—è–∑–∏ &gt;3 –º–∏–Ω ‚Üí –∞–≤—Ç–æ–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞  
- **Watchdog RD6018** ‚Äî –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö &gt;5 –º–∏–Ω (–∏–ª–∏ &gt;1 –º–∏–Ω –ø—Ä–∏ U&gt;15–í) ‚Üí –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ OFF  

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- **Phantom charge** ‚Äî –µ—Å–ª–∏ —Ç–æ–∫ —É–ø–∞–ª –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞ –∑–∞ &lt;10 –º–∏–Ω, –≤ –ª–æ–≥ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –≤–æ–∑–º–æ–∂–Ω–æ–π —Å—É–ª—å—Ñ–∞—Ç–∞—Ü–∏–∏/–ø–æ—Ç–µ—Ä–µ —ë–º–∫–æ—Å—Ç–∏  
- **–í–∞–ª–∏–¥–∞—Ü–∏—è Custom** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ V/I, –¥–µ–ª—å—Ç—ã, –ª–∏–º–∏—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏; –¥–ª—è —Ç–æ–∫–∞ 10.1‚Äì18–ê ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ  

---

## üì± –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –°–∫—Ä–∏–Ω—à–æ—Ç—ã

- **–î–∞—à–±–æ—Ä–¥ (–∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ):** –≥—Ä–∞—Ñ–∏–∫ U/I, —Å—Ç–∞—Ç—É—Å, LIVE (V, I, T, CC/CV), –∫–Ω–æ–ø–∫–∏ –û–±–Ω–æ–≤–∏—Ç—å, –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ, AI –ê–Ω–∞–ª–∏–∑, –õ–æ–≥–∏, –°—Ç–æ–ø, –†–µ–∂–∏–º—ã.
- **–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ —Ä–µ–∂–∏–º—É:** —Ç–æ—Ç –∂–µ –≥—Ä–∞—Ñ–∏–∫, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –±–ª–æ–∫ (—ç—Ç–∞–ø, —É—Å—Ç–∞–≤–∫–∏, —É—Å–ª–æ–≤–∏–µ —Ñ–∏–Ω–∏—à–∞ ŒîV/–≤—Ä–µ–º—è, —ë–º–∫–æ—Å—Ç—å) –∏ —Ç–µ –∂–µ –∫–Ω–æ–ø–∫–∏.
- **–í—ã–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è –∑–∞—Ä—è–¥–∞ (–ê–≤—Ç–æ):** –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏ –¥–æ 16.5–í –∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –ê–ö–ë –æ—Ç –±–æ—Ä—Ç—Å–µ—Ç–∏, –∫–Ω–æ–ø–∫–∏ Ca/Ca, EFB, AGM –∏ ¬´–†—É—á–Ω–æ–π —Ä–µ–∂–∏–º¬ª.

–ß—Ç–æ–±—ã –≤ README –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –∫–∞—Ä—Ç–∏–Ω–∫–∏, –¥–æ–±–∞–≤—å—Ç–µ –≤ –ø–∞–ø–∫—É `assets/` —Ñ–∞–π–ª—ã `dashboard.png`, `fullinfo.png`, `modes.png` (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ: –¥–∞—à–±–æ—Ä–¥, –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ, –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–æ–≤) –∏ –∑–∞–∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

### –î–∞—à–±–æ—Ä–¥ (–≥—Ä–∞—Ñ–∏–∫ + –ø–æ–¥–ø–∏—Å—å + –∫–Ω–æ–ø–∫–∏)

- –ü–æ–¥ –≥—Ä–∞—Ñ–∏–∫–æ–º: —Å—Ç—Ä–æ–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ (—Ä–µ–∂–∏–º, —Ç–∏–ø –ê–ö–ë, –≤—Ä–µ–º—è) –∏ —Å—Ç—Ä–æ–∫–∞ LIVE (V, I, T, CC/CV).  
- **üîÑ –û–ë–ù–û–í–ò–¢–¨** ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞—à–±–æ—Ä–¥ (–≥—Ä–∞—Ñ–∏–∫ + –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ).  
- **üìã –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ** ‚Äî —Ç–æ—Ç –∂–µ –≥—Ä–∞—Ñ–∏–∫ + –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç (—ç—Ç–∞–ø, —É—Å—Ç–∞–≤–∫–∏, —É—Å–ª–æ–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞, —ë–º–∫–æ—Å—Ç—å) –∏ —Ç–µ –∂–µ –∫–Ω–æ–ø–∫–∏.  
- **üß† AI –ê–ù–ê–õ–ò–ó**, **üìù –õ–û–ì–ò –°–û–ë–´–¢–ò–ô**, **–°—Ç–∞—Ä—Ç/–°—Ç–æ–ø**, **‚öôÔ∏è –†–ï–ñ–ò–ú–´**.

### –õ–æ–≥–∏ —Å–æ–±—ã—Ç–∏–π

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞: **—Å—Ç–∞—Ä—Ç** (START, —ë–º–∫–æ—Å—Ç—å/–ø—Ä–æ—Ñ–∏–ª—å), –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ **‚îî** —Å—Ç—Ä–æ–∫–∏ –ø–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º, –ø—Ä–∏ **–∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏** ‚Äî –≤—Ä–µ–º—è –Ω–∞ —ç—Ç–∞–ø–µ, —ë–º–∫–æ—Å—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ, T, V, I –≤ –º–æ–º–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞.

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+  
- Home Assistant —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π RD6018  
- Telegram Bot Token  
- DeepSeek API Key (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è AI)  

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
git clone https://github.com/timspb/rd6018_bot.git
cd rd6018_bot
pip install -r requirements.txt
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env: TG_TOKEN, HA_URL, HA_TOKEN –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ DEEPSEEK_API_KEY, USER_TIMEZONE, ALLOWED_CHAT_IDS
python bot.py
```

### Docker

```bash
docker build -t rd6018-bot .
docker run -d --env-file .env rd6018-bot
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (.env)

```env
TG_TOKEN=...
HA_URL=http://homeassistant:8123
HA_TOKEN=...
DEEPSEEK_API_KEY=...
USER_TIMEZONE=Europe/Moscow
# ALLOWED_CHAT_IDS=123,456  # –ø—É—Å—Ç–æ = –¥–æ—Å—Ç—É–ø —É –≤—Å–µ—Ö
```

### –°—É—â–Ω–æ—Å—Ç–∏ Home Assistant (RD6018)

- –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –Ω–∞ –ê–ö–ë, –≤—ã—Ö–æ–¥–Ω–æ–π —Ç–æ–∫, –≤–Ω–µ—à–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã—Ö–æ–¥–∞  
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å –≤—ã—Ö–æ–¥–∞, —É—Å—Ç–∞–≤–∫–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –∏ —Ç–æ–∫–∞, –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ ‚Äî OVP/OCP  

(–¢–æ—á–Ω—ã–µ –∏–º–µ–Ω–∞ entity –∑–∞–¥–∞—é—Ç—Å—è –≤ `config.py` / ENTITY_MAP.)

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ bot.py           # Telegram-–±–æ—Ç, –¥–∞—à–±–æ—Ä–¥, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –≤—ã–∑–æ–≤ charge_logic
‚îú‚îÄ‚îÄ charge_logic.py  # FSM –∑–∞—Ä—è–¥–∞, –ø—Ä–æ—Ñ–∏–ª–∏, —Ç—Ä–∏–≥–≥–µ—Ä—ã, –∑–∞—â–∏—Ç—ã
‚îú‚îÄ‚îÄ hass_api.py      # –ö–ª–∏–µ–Ω—Ç Home Assistant API
‚îú‚îÄ‚îÄ graphing.py      # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚îú‚îÄ‚îÄ database.py      # SQLite, –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚îú‚îÄ‚îÄ charging_log.py  # –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π (charging_history.log)
‚îú‚îÄ‚îÄ ai_engine.py     # DeepSeek
‚îú‚îÄ‚îÄ time_utils.py    # –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îî‚îÄ‚îÄ config.py        # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã, ENTITY_MAP, MAX_VOLTAGE
```

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –æ—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π **MIT**.  

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫.** –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª. –ê–≤—Ç–æ—Ä—ã –Ω–µ –Ω–µ—Å—É—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ —É—â–µ—Ä–± –ê–ö–ë, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—é –∏–ª–∏ –∏–º—É—â–µ—Å—Ç–≤—É. –†–∞–±–æ—Ç–∞ —Å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ–º –∏ —Ç–æ–∫–æ–º —Ç—Ä–µ–±—É–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ—Å–Ω–æ–≤ –∑–∞—Ä—è–¥–∫–∏ —Å–≤–∏–Ω—Ü–æ–≤–æ-–∫–∏—Å–ª–æ—Ç–Ω—ã—Ö –ê–ö–ë. –ù–µ –æ—Å—Ç–∞–≤–ª—è–π—Ç–µ –∑–∞—Ä—è–¥ –±–µ–∑ –ø—Ä–∏—Å–º–æ—Ç—Ä–∞ –Ω–∞ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è.
